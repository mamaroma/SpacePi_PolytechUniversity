Тогда можем ли мы сделать временную метку, логика

1) Запускаем скрипт, анализируем первое сообщение, получаем его данные и его дату-start-flag, сохраняем эту дату(каким образом лучше это сделать-тебе решать). 
2) Скрипт наш работает, мы выяснили, что сервер телеграмм по безопасности сбрасывает соединение каждые 99 сообщений, тогда нам надо записывать дату 99-го сообщения тоже, как промежуточный флаг-middle-flag. 
3) Автоматически Завершать подключение, перезапускать его(автоматически), можем делать это с задержкой небольшой, если того требует политика безопасности Телеграмм. 4) Затем, при автоматическом перезапуске, мы идем с middle-flag следующие 99 сообщений и обновляем наш middle-flag после прохождения и так далее. Тут важно различать принудительное завершение скрипта и автоматическое.
5) Если в процессе прохода мы набрали требуемое количество записей о сущности(например 10) мы записываем дату нашего последнего собранного сообщения наш end-flag. 
6) Если, спустя время, мы опять запустили скрипт вручную , чтобы собрать следующие 10 записей о сущности, мы идем с самого начала, с самого нового сообщения канала, идем мы по принципу описанному выше до старого start-flag-old, дойдя до него, мы пропускаем все записи от него до старого end-flag-old, ставим метку middle-flag и идем от end-flag-old следующие сообщения пока не найдем 10 записей архивных позже end-flag-old.

7) Продумать, если с start-flag-new не дойти до start-flag-old, потому что в этом случае между ними останутся необработанные нами записи и при перезапуске, мы можем их случайно пропустить или не обработать. То есть если возникла ошибка


Идея была идти от statr до end через midle, пока не соберем нужное число записей, откидывая обарботанные-пройденные-промежуточные записи, чтобы не терять на них время, откидывать их как раз по дате, оставляя в массиве необработанных сообзщений только действительно не пройденные нашим скриптом. поскольку flag - это даты , смысл просто в том, что мы отфильтровываем большие объемы данных по дате и  не анализируем их, облегчая скрипт